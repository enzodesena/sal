/*
 directivityspherical_test.cpp
 Spatial Audio Library (SAL)
 Copyright (c) 2011, Enzo De Sena
 All rights reserved.

 Authors: Enzo De Sena, enzodesena@gmail.com

 */

#include "microphone.h"
#include "salconstants.h"
#include "sofamic.h"

using sal::dsp::Point;
using sal::dsp::Quaternion;

namespace sal {

bool SofaMic::Test(const dsp::Point& source_point, const Signal& cmp_left,
                   const Signal& cmp_right) {
  Time sampling_frequency(48000);

  MonoBuffer impulse(384);
  impulse.SetSample(0, 1.0);

  // If you want to run this test you need to download the file from
  // https://publications.rwth-aachen.de/record/807373
  // I decided not to include it in the repo since it is rather heavy (170 MB)
  SofaMic mic(Point(0.0, 0.0, 0.0), dsp::Quaternion::Identity(),
              "resources/hrtfs/aachen_kemar/Kemar_HRTF_sofa.sofa",
              sampling_frequency);
  StereoBuffer buffer(impulse.num_samples());

  mic.AddPlaneWave(impulse, source_point, buffer);

  double norm_constant(
      1.0 / 0.89345);  // For some reason the Cpp and Matlab spit out values
                       // with a constant multiplicative factor

  Signal cmp_left_normalised(cmp_left.size());
  Signal cmp_right_normalised(cmp_left.size());

  std::transform(cmp_left.begin(), cmp_left.end(), cmp_left_normalised.begin(),
                 [norm_constant](Sample val) { return val * norm_constant; });
  std::transform(cmp_right.begin(), cmp_right.end(),
                 cmp_right_normalised.begin(),
                 [norm_constant](Sample val) { return val * norm_constant; });

  ASSERT(dsp::IsEqual(buffer.GetLeftReadView(), cmp_left_normalised));
  ASSERT(dsp::IsEqual(buffer.GetRightReadView(), cmp_right_normalised));
  return true;
}

bool SofaMic::Test() {
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Test front direction
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

  std::vector<Sample> cmp_front_left = {
      -1.443498e-02, 6.508981e-03,  7.053675e-03,  -1.514648e-02, 2.947150e-02,
      -4.104304e-02, 5.137588e-02,  -6.592099e-02, 6.303528e-02,  -7.638478e-02,
      7.512713e-02,  -5.984829e-02, 5.708293e-02,  -3.039451e-02, 4.171075e-03,
      1.081772e+00,  9.429439e-01,  2.943991e-01,  -2.514935e-01, 2.405910e-01,
      -6.829542e-02, -7.602630e-01, -1.034323e+00, -6.726162e-01, -5.231664e-02,
      6.231266e-02,  1.091443e+00,  6.576470e-01,  2.516598e-01,  -1.777140e-01,
      -4.063561e-01, -9.326573e-02, -4.935861e-02, 2.578734e-01,  3.565559e-03,
      6.869552e-02,  -1.490269e-01, -1.476691e-01, -3.652074e-02, 3.293469e-02,
      6.859080e-02,  5.478488e-03,  -3.289450e-02, -1.758640e-01, -2.613057e-02,
      -8.911888e-02, 7.293168e-03,  3.220893e-02,  -1.228021e-03, 1.411796e-02,
      -1.463441e-02, 3.903640e-02,  5.038770e-02,  6.056227e-02,  2.114309e-02,
      -4.288641e-02, -2.577963e-02, -2.183281e-02, 1.553099e-02,  3.296682e-02,
      8.292894e-04,  1.156978e-02,  -3.696481e-02, -1.868869e-03, -8.559502e-03,
      2.580421e-02,  2.236116e-03,  8.633358e-03,  -1.043877e-02, -3.205526e-02,
      -7.976338e-03, -1.914215e-02, 1.979849e-02,  -5.644428e-03, 3.495772e-02,
      -7.610529e-04, 2.085119e-02,  -4.291133e-03, -5.048888e-03, -8.170529e-03,
      -1.288118e-02, 2.803560e-04,  -1.337463e-02, 8.892342e-03,  -5.581871e-03,
      1.806241e-02,  -1.593565e-02, 1.287670e-02,  -9.294554e-03, 2.114946e-02,
      7.707538e-03,  1.298410e-02,  3.912408e-03,  -1.344217e-02, 7.604061e-03,
      -1.372774e-02, 1.403748e-02,  -1.266075e-02, 2.125031e-02,  -1.957599e-02,
      2.700422e-03,  -1.204638e-02, 1.667614e-04,  -5.536372e-03, -8.380997e-03,
      1.375647e-02,  -1.203017e-02, 1.821053e-02,  -1.067053e-02, 1.451421e-02,
      -1.381219e-02, 1.497119e-02,  -8.000806e-03, -3.410439e-03, -6.734028e-03,
      -7.073283e-03, 3.325668e-03,  -1.492338e-02, 1.627038e-02,  -1.472739e-02,
      1.201632e-02,  -1.143992e-02, 1.190688e-02,  -1.795411e-03, 5.525500e-03,
      1.600782e-03,  -5.768811e-03, -1.770198e-03, -1.503235e-02, 1.136625e-02,
      -1.227895e-02, 1.383933e-02,  -4.854687e-03, 9.257753e-03,  -1.579663e-03,
      4.277455e-03,  1.821730e-03,  -7.110734e-03, 3.464123e-03,  -8.395430e-03,
      6.504709e-03,  -8.226001e-03, 8.901660e-03,  -5.670303e-03, 2.370096e-03,
      -1.908913e-03, -1.606730e-04, 5.431699e-03,  -1.164235e-03, 6.429981e-03,
      -6.925988e-03, -9.155168e-04, -4.323231e-03, 1.432729e-03,  -3.095350e-03,
      3.150881e-03,  2.918594e-03,  -3.392676e-03, 2.375214e-04,  -3.274926e-03,
      1.668355e-03,  -2.978985e-03, 3.925034e-03,  2.654511e-03,  1.199810e-04,
      3.225372e-03,  -1.114925e-03, 1.855046e-03,  -3.664706e-03, 2.665811e-03,
      -1.593607e-03, 3.431427e-04,  -3.862195e-05, -7.181531e-04, 9.304413e-04,
      -3.866540e-03, 4.781179e-03,  -4.359541e-03, 3.388784e-03,  -3.854037e-03,
      1.994568e-03,  -3.680594e-03, -3.044837e-04, 2.233426e-03,  -3.374891e-03,
      4.197270e-03,  -4.177882e-03, 6.185794e-03,  -6.431817e-03, 5.917974e-03,
      -4.357907e-03, 2.415806e-03,  -1.500324e-03, 4.762174e-04,  3.022053e-03,
      -4.379671e-03, 6.981004e-03,  -6.718609e-03, 6.406847e-03,  -7.468606e-03,
      6.613350e-03,  -6.148691e-03, 2.677701e-03,  -7.114932e-04, -1.681976e-03,
      2.487975e-03,  -5.517395e-03, 6.889383e-03,  -8.862257e-03, 8.168966e-03,
      -7.628898e-03, 6.539980e-03,  -5.913916e-03, 3.554225e-03,  -1.133561e-03,
      -2.346754e-03, 3.920898e-03,  -5.530710e-03, 7.113814e-03,  -8.388539e-03,
      9.484966e-03,  -8.182903e-03, 6.852090e-03,  -5.094612e-03, 3.557208e-03,
      -1.408497e-03, -1.327323e-03, 4.342196e-03,  -5.994936e-03, 7.227967e-03,
      -7.748475e-03, 8.693255e-03,  -8.467642e-03, 7.323533e-03,  -5.236326e-03,
      3.079851e-03,  -1.433807e-03, -7.650604e-04, 3.078956e-03,  -5.509940e-03,
      7.021234e-03,  -7.374921e-03, 7.635135e-03,  -7.458771e-03, 7.200988e-03,
      -5.640177e-03, 3.694185e-03,  -1.295569e-03, -1.868543e-04, 2.080006e-03,
      -3.695769e-03, 5.748597e-03,  -6.529322e-03, 7.020900e-03,  -6.395662e-03,
      6.223127e-03,  -5.427910e-03, 4.240634e-03,  -2.345043e-03, 4.463266e-04,
      9.769903e-04,  -2.183344e-03, 3.526653e-03,  -4.791356e-03, 5.493876e-03,
      -5.580220e-03, 5.107288e-03,  -4.689911e-03, 4.233019e-03,  -3.321070e-03,
      2.042683e-03,  -4.747136e-04, -5.141900e-04, 1.463221e-03,  -2.207351e-03,
      3.376598e-03,  -3.842294e-03, 4.232028e-03,  -3.752439e-03, 3.921429e-03,
      -3.532345e-03, 3.364636e-03,  -2.467887e-03, 1.671872e-03,  -7.561361e-04,
      4.195729e-04,  5.357182e-04,  -1.382608e-03, 2.377358e-03,  -2.923172e-03,
      3.428852e-03,  -3.465343e-03, 4.160691e-03,  -4.089944e-03, 4.198490e-03,
      -3.388474e-03, 2.938843e-03,  -2.135520e-03, 1.689641e-03,  -1.713137e-05,
      -9.846085e-04, 2.579086e-03,  -3.079300e-03, 4.481338e-03,  -4.930621e-03,
      6.109536e-03,  -5.811001e-03, 5.940467e-03,  -4.931124e-03, 4.499000e-03,
      -2.994359e-03, 1.858711e-03,  5.198630e-04,  -2.001048e-03, 4.021148e-03,
      -5.154570e-03, 7.013837e-03,  -7.779767e-03, 8.557633e-03,  -8.060078e-03,
      7.675043e-03,  -6.134399e-03, 5.065760e-03,  -2.372545e-03, 4.280930e-04,
      2.551536e-03,  -4.570648e-03, 7.071903e-03,  -8.512356e-03, 1.040979e-02,
      -1.060690e-02, 1.089571e-02,  -9.481868e-03, 8.609726e-03,  -6.004130e-03,
      4.027646e-03,  -4.626318e-04, -2.393052e-03, 6.009849e-03,  -7.936639e-03,
      1.090643e-02,  -1.212022e-02, 1.376078e-02,  -1.296662e-02, 1.263089e-02,
      -1.040488e-02, 8.566912e-03,  -4.668211e-03, 1.664693e-03,  2.762908e-03,
      -5.739108e-03, 1.034112e-02,  -1.243328e-02, 1.480952e-02,  -1.579060e-02,
      1.709422e-02,  -1.581291e-02, 1.409839e-02,  -1.019820e-02, 8.016894e-03,
      -2.845987e-03, -1.448119e-03, 6.936843e-03,  -1.081488e-02, 1.463931e-02,
      -1.835636e-02, 2.014604e-02,  -2.170529e-02, 2.103569e-02,  -1.916676e-02,
      1.633614e-02,  -1.099665e-02, 7.703053e-03,  -6.140421e-04, -6.637530e-03,
      1.262783e-02,  -1.829377e-02, 2.343825e-02,  -2.813676e-02, 3.242246e-02,
      -3.173304e-02, 3.071100e-02,  -2.584548e-02, 2.363344e-02};

  std::vector<Sample> cmp_front_right = {
      -1.668558e-02, 1.815152e-02,  -1.136062e-02, 1.078972e-02,  -2.082674e-03,
      -5.038424e-03, 1.254026e-02,  -2.512742e-02, 2.600422e-02,  -4.639630e-02,
      5.093503e-02,  -5.155857e-02, 6.210726e-02,  -5.172843e-02, 5.728436e-02,
      1.059626e+00,  9.567349e-01,  1.373356e-01,  2.285768e-01,  3.949393e-01,
      -3.153652e-01, -1.350650e+00, -1.255997e+00, -1.567187e-01, -1.096699e-01,
      4.370108e-01,  1.019033e+00,  3.799716e-01,  1.300891e-01,  -1.148272e-01,
      -1.798430e-01, 1.975423e-02,  2.298917e-01,  -2.777807e-02, -2.149736e-01,
      -1.226121e-01, -1.641457e-01, 4.655768e-02,  1.015702e-02,  -1.280396e-01,
      3.830889e-03,  1.112188e-01,  7.852760e-03,  -2.366119e-02, -7.888781e-02,
      -2.860105e-03, 6.238727e-02,  -6.103066e-02, -1.182781e-01, -6.710703e-02,
      3.723929e-02,  4.202404e-02,  6.944305e-02,  1.827112e-02,  2.246205e-02,
      3.525700e-02,  1.353709e-02,  1.180943e-02,  -1.068494e-02, -1.092093e-02,
      -3.173022e-03, -2.370089e-02, -3.969882e-02, 9.841284e-03,  1.978870e-02,
      1.817516e-02,  -6.507221e-03, -3.361693e-03, 9.904560e-04,  -3.626033e-03,
      -9.098715e-03, -1.056590e-02, -1.287119e-02, 7.334260e-03,  2.737609e-02,
      1.126424e-02,  8.152188e-04,  -1.203959e-02, -2.206429e-03, -1.241742e-02,
      -5.399378e-03, -4.934955e-03, 3.937501e-04,  2.055960e-03,  1.442891e-02,
      -2.629834e-03, -1.045474e-03, 1.078853e-02,  1.040084e-03,  7.413588e-03,
      -1.590422e-03, 1.376862e-02,  -5.327969e-03, 5.312724e-03,  1.013594e-03,
      1.580257e-03,  -8.031470e-03, 3.534235e-03,  6.308432e-03,  -9.535206e-03,
      -1.749969e-03, -7.328951e-03, -2.176041e-03, -1.917586e-02, 7.197786e-03,
      -4.738696e-03, 2.424855e-03,  -4.522738e-04, 5.722504e-03,  1.133808e-03,
      8.475383e-04,  1.307194e-02,  -1.012884e-02, -7.480910e-03, -1.470655e-02,
      8.039956e-03,  -1.074878e-02, 4.924610e-03,  1.490861e-05,  -2.465938e-03,
      -1.456544e-03, 1.799991e-03,  5.394360e-03,  -6.739418e-03, 8.343925e-03,
      -3.835025e-03, 4.332391e-03,  -1.158883e-02, 7.633726e-03,  -4.039603e-03,
      -2.028055e-03, 2.307750e-03,  3.200740e-03,  6.035966e-03,  -1.433355e-04,
      1.100640e-02,  -8.757505e-03, 3.089869e-03,  -3.573957e-03, 4.327981e-03,
      -8.501239e-03, 2.443346e-03,  2.940408e-03,  -2.148381e-03, 8.231153e-04,
      -1.750777e-03, 6.739538e-03,  -6.978477e-03, 6.368594e-03,  -5.213242e-03,
      -1.271761e-03, -3.636077e-03, 4.256042e-03,  -3.301342e-03, -2.761051e-03,
      5.779510e-03,  -2.592169e-03, -1.117943e-03, -5.676271e-03, 3.869513e-03,
      -6.850164e-03, 2.545494e-03,  1.940928e-03,  2.173410e-03,  -9.366836e-04,
      2.665887e-03,  2.286083e-03,  -4.186051e-03, 2.586066e-03,  -1.479047e-03,
      6.968944e-04,  -3.887410e-03, 3.465991e-03,  -1.271463e-03, -1.161074e-03,
      7.052007e-04,  9.607803e-04,  -1.461664e-03, -1.807243e-03, 2.455965e-03,
      -2.905849e-03, -7.373321e-04, 6.094243e-04,  1.257044e-03,  -2.357165e-03,
      9.897603e-04,  1.494523e-03,  -1.020291e-03, -3.933491e-04, 1.228749e-03,
      -3.393305e-05, -1.324923e-03, 1.455487e-03,  1.633752e-03,  -1.118058e-03,
      7.325941e-04,  1.552192e-03,  -7.557061e-04, -1.130769e-03, 9.807273e-04,
      3.283843e-04,  -2.558360e-03, 1.201195e-03,  -4.486740e-04, -4.506508e-04,
      -1.941433e-03, 1.777696e-03,  -1.431584e-03, -9.175141e-04, 8.883377e-04,
      -1.778603e-04, -3.639062e-04, -1.497944e-03, 2.577623e-03,  -3.023903e-03,
      1.054133e-03,  -9.404073e-04, 1.624405e-03,  -2.093673e-03, 1.359046e-03,
      1.069595e-03,  -1.471644e-03, 1.336575e-03,  -8.806071e-04, 2.027998e-03,
      -3.373603e-03, 3.588756e-03,  -2.168228e-03, 1.240710e-03,  -1.231894e-03,
      1.760188e-03,  -5.956988e-04, -1.241107e-03, 2.430772e-03,  -2.424264e-03,
      1.922450e-03,  -2.740766e-03, 3.634241e-03,  -3.851540e-03, 2.545143e-03,
      -1.144310e-03, 8.123766e-04,  -7.331732e-04, 7.166217e-05,  1.874877e-03,
      -3.084519e-03, 3.398216e-03,  -2.673032e-03, 3.142772e-03,  -3.529829e-03,
      3.829109e-03,  -2.361615e-03, 1.117313e-03,  5.235213e-05,  5.837654e-05,
      9.232603e-04,  -2.137729e-03, 3.645322e-03,  -3.763732e-03, 3.287664e-03,
      -3.032650e-03, 3.476504e-03,  -3.268990e-03, 2.313048e-03,  -5.621477e-04,
      -3.651960e-04, 8.716031e-04,  -1.248452e-03, 2.601824e-03,  -3.565271e-03,
      4.097653e-03,  -3.220410e-03, 3.057134e-03,  -2.821645e-03, 3.038670e-03,
      -1.713744e-03, 6.865597e-04,  8.625658e-04,  -8.679063e-04, 1.744736e-03,
      -2.206857e-03, 3.611237e-03,  -3.624290e-03, 3.492424e-03,  -2.573718e-03,
      2.842460e-03,  -2.388565e-03, 1.908532e-03,  -4.675205e-04, -3.045670e-04,
      1.271631e-03,  -1.115920e-03, 2.251567e-03,  -2.780342e-03, 3.694117e-03,
      -3.023125e-03, 2.886647e-03,  -2.299242e-03, 2.839899e-03,  -1.826444e-03,
      1.308738e-03,  3.336755e-04,  -2.657970e-04, 1.245894e-03,  -1.321929e-03,
      2.772639e-03,  -2.762492e-03, 3.514841e-03,  -2.533992e-03, 3.061617e-03,
      -2.633301e-03, 2.961899e-03,  -1.505598e-03, 1.138637e-03,  1.833638e-04,
      2.050400e-05,  1.227697e-03,  -1.707089e-03, 3.166161e-03,  -3.118866e-03,
      3.714740e-03,  -3.062136e-03, 4.067985e-03,  -3.209464e-03, 3.253410e-03,
      -1.553925e-03, 1.353382e-03,  1.519794e-05,  -1.005853e-04, 2.047008e-03,
      -2.538006e-03, 4.088894e-03,  -3.692053e-03, 4.821957e-03,  -4.174422e-03,
      5.232865e-03,  -3.820236e-03, 3.716578e-03,  -1.611058e-03, 1.632035e-03,
      3.720708e-04,  -1.107619e-03, 3.543791e-03,  -3.830770e-03, 5.561188e-03,
      -5.238785e-03, 6.641397e-03,  -5.830482e-03, 6.272948e-03,  -4.493497e-03,
      4.023022e-03,  -1.405085e-03, 8.846410e-04,  1.926657e-03,  -2.863528e-03,
      5.900178e-03,  -6.234212e-03, 7.482043e-03,  -7.511007e-03, 8.951018e-03,
      -7.770296e-03, 7.153976e-03,  -4.426019e-03, 3.602639e-03,  -1.051737e-03,
      -1.249244e-03, 4.378464e-03,  -6.527937e-03, 8.622375e-03,  -9.650639e-03,
      1.106419e-02,  -1.140844e-02, 1.168009e-02,  -9.567437e-03, 7.935650e-03,
      -4.821416e-03, 2.417979e-03,  1.501875e-03,  -5.135272e-03, 9.805647e-03,
      -1.228468e-02, 1.591760e-02,  -1.630451e-02, 1.996251e-02};

  Test(Point(1.0, 0.0, 0.0), cmp_front_left, cmp_front_right);

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Test left direction
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  std::vector<Sample> cmp_left_left = {
      -1.748094e-01, 2.614689e-01,  -3.713298e-01, 9.034796e-01,  2.597140e+00,
      7.489367e-01,  8.554378e-01,  -1.784291e+00, -2.409458e+00, -1.312564e+00,
      -8.870823e-01, 1.386958e+00,  2.068479e+00,  1.911901e+00,  -3.119155e-01,
      -1.174776e+00, -1.116110e+00, -8.952651e-01, 4.430687e-01,  6.770883e-01,
      3.695253e-01,  5.715950e-02,  -2.711523e-01, -5.145991e-01, -3.057572e-01,
      -7.858413e-02, 2.123760e-01,  2.062646e-01,  1.369568e-01,  1.204491e-01,
      3.499733e-02,  -1.199832e-01, -1.514848e-01, -1.165022e-01, -1.161095e-01,
      -7.296906e-02, 2.540362e-02,  1.644014e-01,  -1.213180e-02, -8.730414e-03,
      -8.390307e-02, -1.256302e-02, 4.518923e-02,  4.627144e-02,  6.497851e-02,
      -1.772008e-02, -3.472384e-02, -6.718519e-02, -3.268157e-02, -4.106139e-02,
      1.967069e-02,  -2.622237e-03, 2.323590e-02,  -8.454591e-03, 1.349920e-02,
      2.383630e-03,  -1.563638e-02, -4.762948e-03, -3.632237e-02, 1.058779e-02,
      1.808581e-02,  4.362929e-02,  1.795182e-02,  -6.685097e-03, -3.391220e-02,
      -2.301118e-02, -3.566051e-02, 1.842383e-02,  6.189872e-03,  2.483042e-02,
      9.165979e-03,  -1.442709e-02, -7.463519e-03, -2.548374e-02, 2.537321e-02,
      8.550023e-03,  3.807003e-02,  7.179832e-03,  2.465216e-02,  -1.182343e-02,
      8.056064e-04,  -1.498084e-02, -8.672397e-03, -3.013807e-03, -8.524190e-03,
      1.714501e-02,  -1.239759e-02, 1.749989e-02,  -2.891184e-02, 4.076626e-03,
      -3.234831e-02, 9.490674e-04,  -1.856417e-02, -7.597397e-03, -1.007891e-02,
      -1.652542e-02, 5.959292e-03,  -2.828190e-02, 2.386288e-02,  -2.038662e-02,
      9.543817e-03,  -1.708293e-02, 6.342451e-03,  -1.468356e-02, 7.926782e-03,
      -2.883792e-03, -9.355764e-03, 4.777133e-03,  -2.549958e-02, 1.563525e-02,
      -2.323238e-02, 2.327635e-02,  -9.979169e-03, 1.387858e-02,  -1.018057e-02,
      -2.290040e-03, -1.210948e-02, -1.242210e-02, 1.467975e-02,  -5.015706e-03,
      2.272461e-02,  -1.623963e-02, 1.710238e-02,  -1.867932e-02, 6.635333e-03,
      -5.307975e-03, 6.861491e-03,  5.335634e-03,  -4.376297e-03, 4.222435e-03,
      -1.449740e-02, 1.096881e-02,  -7.693560e-03, 1.599945e-02,  -1.206046e-02,
      9.914213e-03,  -7.855224e-03, 3.013467e-03,  1.078023e-03,  -3.552114e-04,
      1.058985e-02,  -9.782320e-03, 8.505843e-03,  -1.101949e-02, 7.431200e-03,
      -4.160408e-03, 6.408257e-03,  -7.898122e-03, 2.713263e-03,  2.071808e-03,
      -1.428604e-03, 4.768237e-03,  -5.235245e-03, 6.779790e-03,  -1.059113e-02,
      2.835500e-03,  -5.207368e-03, 2.379610e-03,  -1.033710e-03, 1.514085e-04,
      1.586716e-04,  -3.492657e-03, 2.606383e-03,  -3.456994e-03, 1.889400e-03,
      -3.487079e-03, 3.056994e-03,  -2.911506e-03, -1.763876e-03, 2.693096e-04,
      -3.619051e-03, 3.792274e-04,  -2.006660e-03, 2.140617e-03,  -2.476007e-03,
      -1.135472e-03, -4.745424e-04, -2.594345e-03, 1.655935e-04,  -3.089342e-03,
      2.763857e-03,  -4.682949e-03, 1.866718e-03,  -2.433655e-03, -9.122817e-04,
      -7.140956e-04, -1.930014e-03, 2.517584e-03,  -5.580049e-03, 4.570225e-03,
      -5.450621e-03, 3.457512e-03,  -4.952639e-03, 2.741521e-03,  -2.524157e-03,
      -9.856621e-04, 2.145489e-03,  -3.547450e-03, 4.497210e-03,  -6.499966e-03,
      6.859104e-03,  -7.949889e-03, 5.733172e-03,  -4.947265e-03, 3.628810e-03,
      -1.566490e-03, 1.072089e-04,  3.502329e-03,  -5.158702e-03, 6.967346e-03,
      -7.031679e-03, 8.602738e-03,  -8.192599e-03, 8.414418e-03,  -5.593985e-03,
      4.086693e-03,  -1.209011e-03, -1.939510e-04, 3.347049e-03,  -5.377134e-03,
      8.187463e-03,  -8.602306e-03, 9.313822e-03,  -8.709103e-03, 8.702606e-03,
      -6.972914e-03, 4.839346e-03,  -1.674165e-03, -5.370565e-04, 3.126999e-03,
      -5.118141e-03, 7.732193e-03,  -9.138119e-03, 1.006763e-02,  -9.206173e-03,
      8.688127e-03,  -7.200020e-03, 5.731981e-03,  -2.855036e-03, 1.027311e-04,
      2.827391e-03,  -4.567423e-03, 6.837311e-03,  -8.200894e-03, 9.595871e-03,
      -9.539853e-03, 8.840029e-03,  -7.257740e-03, 6.019145e-03,  -3.777484e-03,
      1.658794e-03,  1.420912e-03,  -3.570286e-03, 5.461413e-03,  -6.660823e-03,
      8.134612e-03,  -8.423116e-03, 8.881498e-03,  -7.352356e-03, 6.356681e-03,
      -4.534468e-03, 3.107731e-03,  -6.680706e-04, -9.859061e-04, 3.962956e-03,
      -4.467690e-03, 6.289253e-03,  -6.466851e-03, 7.708272e-03,  -6.785505e-03,
      7.182193e-03,  -4.739400e-03, 4.773790e-03,  -2.455872e-03, 1.943466e-03,
      7.974493e-04,  -1.402923e-03, 4.126670e-03,  -3.468374e-03, 6.042110e-03,
      -5.354247e-03, 7.089179e-03,  -5.545338e-03, 6.244183e-03,  -4.135826e-03,
      4.902391e-03,  -2.155910e-03, 2.596731e-03,  8.100669e-04,  -5.006840e-04,
      3.183305e-03,  -2.990007e-03, 5.894542e-03,  -5.082667e-03, 7.621686e-03,
      -5.726059e-03, 7.575313e-03,  -5.535623e-03, 6.400923e-03,  -3.463129e-03,
      3.731171e-03,  1.348654e-04,  1.972566e-04,  3.470356e-03,  -3.905614e-03,
      7.214983e-03,  -7.033050e-03, 9.622921e-03,  -8.186713e-03, 1.035001e-02,
      -7.818122e-03, 8.346592e-03,  -4.845021e-03, 4.067499e-03,  -5.160769e-06,
      -1.063367e-03, 5.700847e-03,  -6.732581e-03, 1.082456e-02,  -1.067510e-02,
      1.335631e-02,  -1.202977e-02, 1.332047e-02,  -9.940653e-03, 9.473849e-03,
      -4.632806e-03, 3.014565e-03,  2.394469e-03,  -4.564616e-03, 9.966691e-03,
      -1.135650e-02, 1.581996e-02,  -1.532384e-02, 1.781914e-02,  -1.551552e-02,
      1.555381e-02,  -1.114754e-02, 8.891542e-03,  -3.025668e-03, 3.642539e-04,
      6.832758e-03,  -9.669214e-03, 1.574425e-02,  -1.790045e-02, 2.136623e-02,
      -2.146880e-02, 2.244397e-02,  -1.858325e-02, 1.769824e-02,  -1.181868e-02,
      7.373468e-03,  -5.427428e-04, -5.018914e-03, 1.217503e-02,  -1.740855e-02,
      2.376668e-02,  -2.676737e-02, 2.899521e-02,  -3.030737e-02, 2.930293e-02,
      -2.510769e-02, 2.087753e-02,  -1.298700e-02, 5.887526e-03,  3.436456e-03,
      -1.329791e-02, 2.197357e-02,  -3.048491e-02, 3.950265e-02,  -4.275346e-02,
      4.836618e-02,  -4.714186e-02, 4.871461e-02,  -4.053307e-02, 3.515886e-02,
      -1.929664e-02, 9.636995e-03,  8.279216e-03,  -3.227029e-02, 4.489385e-02,
      -8.332372e-02, 9.042832e-02,  -1.281971e-01, 1.739607e-01};

  std::vector<Sample> cmp_left_right = {
      -1.174067e-03, -6.089425e-04, -9.143039e-04, -6.347969e-04, -1.107469e-03,
      -8.736520e-04, -5.795768e-04, -1.084616e-03, -5.941856e-04, -1.149229e-03,
      -2.046521e-04, -1.359377e-03, 1.874752e-05,  -1.571600e-03, -1.927143e-04,
      -8.497980e-04, -1.258459e-03, 3.473409e-04,  -7.461958e-04, 1.907678e-03,
      7.763644e-04,  1.718578e-03,  6.151868e-04,  8.443399e-04,  2.199676e-04,
      -3.136647e-04, -2.340120e-03, -1.880527e-03, -3.467771e-03, -1.654034e-03,
      -5.675386e-04, 1.124002e-05,  6.390301e-02,  1.386696e-01,  1.667990e-01,
      1.984426e-01,  2.218956e-01,  1.775844e-01,  1.163595e-01,  9.383485e-02,
      7.415929e-02,  -2.592447e-02, -1.303461e-01, -6.693147e-02, -2.056513e-02,
      -1.023123e-01, -1.236417e-01, -4.050608e-02, 5.688550e-02,  1.221591e-01,
      1.230825e-01,  4.702114e-02,  -2.537844e-02, -5.603741e-02, -5.572009e-02,
      -3.874076e-02, -2.239824e-02, 3.328141e-03,  1.232925e-02,  -8.125932e-03,
      -6.447967e-03, 1.890552e-02,  3.166652e-02,  2.227258e-02,  1.487854e-03,
      -9.547225e-03, -9.602922e-03, -4.225131e-03, -5.107602e-03, -1.587619e-02,
      -1.978613e-02, -1.064074e-02, -2.086799e-03, 2.360333e-03,  1.459506e-03,
      3.781331e-03,  2.997859e-03,  -3.037498e-03, -3.024783e-03, -4.986753e-03,
      -1.726264e-03, 6.147858e-05,  -1.104152e-03, -1.642868e-03, 2.226302e-03,
      6.214576e-03,  7.628975e-03,  4.692692e-03,  5.929269e-04,  -8.258133e-04,
      -4.336951e-03, 1.243542e-03,  3.089464e-03,  5.464185e-03,  6.993958e-03,
      6.861513e-03,  8.526619e-03,  9.000555e-03,  8.950825e-03,  5.047077e-03,
      -4.226139e-04, -4.436806e-03, -2.210348e-03, -3.275820e-03, -8.285900e-04,
      -2.094607e-03, -8.703714e-04, 3.068295e-03,  1.599792e-03,  9.566999e-04,
      -1.918092e-03, 1.692611e-04,  3.454283e-03,  7.320187e-03,  7.842002e-03,
      7.123112e-03,  4.131217e-03,  3.283367e-03,  5.681004e-03,  6.937278e-03,
      4.434251e-03,  1.282345e-03,  4.825167e-03,  4.541857e-03,  4.862811e-03,
      5.722284e-03,  3.757222e-03,  1.740517e-03,  3.702022e-03,  4.222135e-03,
      4.484584e-03,  4.453579e-03,  2.731994e-03,  2.920295e-03,  1.226837e-03,
      2.430414e-03,  -2.396734e-04, -3.578003e-03, -4.726134e-03, -3.622189e-03,
      -1.272689e-03, -1.132189e-03, -6.984398e-04, -1.249890e-03, -9.407252e-04,
      8.457129e-04,  3.177810e-03,  1.738531e-03,  -5.151511e-04, -2.003797e-03,
      -2.810274e-03, -2.203413e-03, -1.017626e-03, -1.184698e-03, -2.946821e-03,
      -3.295097e-03, -2.036130e-03, -6.316488e-04, -6.440629e-04, 3.828593e-04,
      -4.369649e-04, -1.750548e-03, -1.147693e-03, -7.728672e-04, -6.225227e-04,
      -5.045009e-04, 7.689437e-04,  7.204426e-04,  9.637231e-05,  8.444975e-04,
      1.347845e-03,  1.511161e-03,  1.806432e-03,  1.730803e-03,  4.395700e-04,
      3.597474e-05,  7.611616e-04,  7.420392e-04,  2.130692e-04,  2.452142e-04,
      5.697458e-04,  -2.380044e-04, -1.454710e-05, 4.045106e-04,  3.278742e-04,
      2.135488e-04,  6.123745e-04,  8.521325e-04,  3.057923e-04,  7.810192e-04,
      9.133311e-04,  7.487714e-04,  5.478032e-04,  1.466688e-03,  1.454798e-03,
      1.244429e-03,  1.564519e-03,  1.500532e-03,  1.241448e-03,  1.084139e-03,
      1.717880e-03,  1.061511e-03,  1.072185e-03,  1.122491e-03,  1.253425e-03,
      7.135651e-04,  8.192231e-04,  9.624849e-04,  2.525744e-04,  2.630590e-04,
      1.639773e-04,  2.037918e-04,  -4.620924e-04, 5.222950e-05,  -2.407632e-04,
      -3.861779e-04, -3.891358e-04, -1.981243e-04, -4.042753e-04, -7.474958e-04,
      -2.311720e-04, -6.450606e-04, -5.518964e-04, -6.944748e-04, -1.851395e-04,
      -6.693304e-04, -4.249414e-04, -2.334118e-04, -3.742874e-04, -4.052719e-04,
      -3.531525e-04, -3.105899e-05, -6.438643e-04, -1.618614e-04, -4.083415e-04,
      -3.315459e-04, -6.674863e-04, -2.865295e-04, -4.632423e-04, -7.248223e-04,
      -3.729289e-04, -5.201002e-04, -4.088581e-04, -6.920521e-04, -1.063794e-04,
      -6.039441e-04, -3.903359e-04, -3.971358e-04, -2.132915e-04, -3.587570e-04,
      -2.642545e-04, 1.284227e-04,  -2.589952e-04, 8.979533e-05,  -3.116950e-05,
      2.424307e-04,  -1.992615e-04, 2.154141e-04,  1.030172e-04,  7.903048e-06,
      3.900503e-05,  4.923623e-05,  1.303538e-04,  -2.228320e-04, 1.581164e-04,
      -1.546536e-04, -4.419521e-05, -2.319399e-04, 3.091975e-05,  -2.824296e-04,
      -2.239085e-04, -6.669472e-05, -2.807870e-04, -1.544432e-04, -3.136985e-04,
      -4.432587e-05, -3.659817e-04, -1.442103e-04, -1.648539e-04, -2.246531e-04,
      -2.799274e-04, -1.868285e-04, -1.574765e-04, -3.387071e-04, -2.493396e-04,
      -2.304421e-04, -3.264843e-04, -4.074705e-04, -2.592580e-04, -4.217179e-04,
      -4.499204e-04, -4.634194e-04, -4.011055e-04, -6.154759e-04, -5.190142e-04,
      -5.114688e-04, -5.378991e-04, -6.171309e-04, -6.284367e-04, -5.538010e-04,
      -7.354065e-04, -5.614255e-04, -6.235947e-04, -5.836655e-04, -6.815579e-04,
      -5.860667e-04, -6.890846e-04, -6.849536e-04, -5.840619e-04, -6.178094e-04,
      -6.657303e-04, -6.657634e-04, -5.674639e-04, -6.398343e-04, -6.307109e-04,
      -6.455437e-04, -5.703750e-04, -7.296540e-04, -6.384983e-04, -6.610843e-04,
      -6.552761e-04, -6.451011e-04, -6.314218e-04, -7.019838e-04, -7.450730e-04,
      -6.224265e-04, -6.357382e-04, -6.984423e-04, -6.993134e-04, -5.973186e-04,
      -6.880239e-04, -6.577124e-04, -6.412824e-04, -6.032946e-04, -7.227535e-04,
      -5.838778e-04, -6.604443e-04, -5.814061e-04, -6.307997e-04, -5.748247e-04,
      -5.858547e-04, -6.831431e-04, -5.574506e-04, -6.856577e-04, -6.028879e-04,
      -7.368748e-04, -4.884340e-04, -7.587429e-04, -5.789157e-04, -6.942749e-04,
      -6.698047e-04, -7.199695e-04, -7.545110e-04, -5.874050e-04, -8.294328e-04,
      -6.437061e-04, -7.217477e-04, -5.763496e-04, -8.428159e-04, -4.726537e-04,
      -7.271999e-04, -6.073439e-04, -7.411519e-04, -6.297019e-04, -6.328218e-04,
      -7.558432e-04, -5.346744e-04, -8.357232e-04, -4.957856e-04, -8.114128e-04,
      -5.361016e-04, -8.534944e-04, -5.630702e-04, -7.565090e-04, -6.384167e-04,
      -7.662711e-04, -6.064968e-04, -6.584168e-04, -8.105066e-04, -5.372945e-04,
      -9.673269e-04, -5.989051e-04, -1.094831e-03, -6.413565e-04};

  Test(Point(0.0, 1.0, 0.0), cmp_left_left, cmp_left_right);

  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Test up direction
  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  std::vector<Sample> cmp_up_left = {
      6.278695e-03,  -1.260725e-02, 7.023667e-03,  -1.802010e-02, 5.002819e-03,
      -1.810761e-02, 5.116906e-03,  -1.001044e-02, 4.183488e-03,  6.477214e-03,
      -1.298215e-03, 3.772881e-01,  5.249438e-01,  6.338549e-01,  8.660288e-01,
      3.467893e-01,  -8.898384e-01, -1.323533e+00, -8.191471e-01, -1.198139e-01,
      6.085824e-01,  7.616786e-01,  4.684833e-01,  2.658510e-02,  -2.604980e-01,
      -3.975972e-01, -2.393974e-01, 1.173217e-01,  2.951631e-01,  2.045541e-01,
      -8.715954e-02, -1.819659e-01, -1.388692e-01, 1.052036e-02,  2.550714e-02,
      -7.242183e-03, 7.146813e-03,  5.233282e-02,  1.144981e-01,  8.190292e-02,
      2.767380e-02,  -3.496671e-02, -1.378563e-02, -5.165178e-02, -5.935475e-02,
      -3.396740e-02, 2.329159e-02,  5.488588e-02,  1.191046e-02,  -2.043611e-02,
      -4.836344e-02, -3.973528e-03, 4.115792e-02,  5.695488e-02,  2.875520e-02,
      1.495348e-02,  2.050851e-02,  2.541287e-02,  -4.120395e-03, -4.318058e-02,
      -5.071771e-02, -3.577118e-02, -2.116907e-02, -1.939164e-02, -1.306601e-02,
      -1.861917e-02, -1.493636e-02, -1.957054e-02, -1.556012e-02, 4.003290e-03,
      5.448915e-02,  5.957493e-02,  1.428479e-02,  -3.606517e-02, -5.677211e-02,
      -3.138288e-02, -1.920022e-03, 1.947891e-02,  1.128957e-02,  1.014990e-02,
      -3.448663e-03, -1.115637e-02, -1.472112e-02, -5.706529e-03, 8.527349e-03,
      1.518673e-02,  9.475898e-03,  -6.050968e-03, -6.150673e-03, -8.492507e-03,
      -3.432432e-03, -1.158850e-02, -7.862072e-03, 1.709315e-03,  1.003343e-02,
      1.038686e-02,  6.572955e-04,  -6.429436e-03, -9.097460e-03, -5.322455e-03,
      4.013927e-04,  5.384818e-03,  3.492663e-03,  6.906662e-03,  2.901499e-03,
      -2.916135e-03, -2.499327e-03, 5.394658e-04,  -7.096231e-04, 2.688120e-03,
      8.159478e-04,  7.522702e-04,  -1.178463e-03, -1.327058e-03, -2.459916e-03,
      -7.414559e-03, -3.146052e-03, -2.417276e-03, 3.280039e-03,  2.979013e-03,
      3.171350e-03,  -3.841872e-03, -2.957992e-03, -6.465194e-03, -1.022190e-03,
      -8.300195e-04, -2.732654e-03, 1.454569e-03,  -4.889371e-03, 1.512404e-03,
      -5.428641e-03, -9.219907e-05, -7.099918e-03, -1.772624e-03, -6.305600e-04,
      -1.050825e-03, 2.326627e-03,  -1.779416e-04, 4.890021e-03,  -3.369899e-03,
      3.326256e-03,  -2.646962e-04, 6.724694e-03,  2.498738e-03,  3.344483e-03,
      -3.126551e-03, -4.920667e-03, -1.124879e-03, -4.703140e-03, 1.825930e-03,
      -4.418775e-03, 4.396914e-03,  -4.759462e-03, 7.423367e-04,  -1.203937e-03,
      -9.823342e-05, 1.418737e-03,  6.214467e-05,  3.789048e-03,  -2.116863e-03,
      2.086285e-03,  -4.105491e-03, 1.442337e-03,  -3.505137e-03, 2.814330e-03,
      -7.491266e-04, -1.320963e-04, 7.160480e-04,  -2.417678e-03, 1.079413e-03,
      -4.533423e-03, 2.054487e-03,  -3.180337e-03, 2.116546e-03,  -1.180327e-03,
      2.030389e-03,  -3.214329e-04, -8.941861e-04, -3.894692e-04, -3.618076e-03,
      1.146081e-03,  -2.385461e-03, 3.089716e-03,  -2.332865e-03, 2.106400e-03,
      -1.085836e-03, 4.391624e-04,  3.081042e-04,  -1.447783e-04, 1.828997e-03,
      -1.699580e-03, 2.632126e-03,  -2.016450e-03, 1.749585e-03,  -1.774328e-03,
      1.270808e-03,  -9.623081e-04, -2.848776e-04, 8.264769e-04,  -1.130507e-03,
      1.453535e-03,  -1.915222e-03, 1.736488e-03,  -2.366384e-03, 1.072288e-03,
      -1.180649e-03, 2.465248e-04,  -1.451969e-04, -6.516774e-04, 9.224017e-04,
      -2.174536e-03, 1.173069e-03,  -2.133965e-03, 1.028856e-03,  -1.729190e-03,
      7.446359e-04,  -6.528497e-04, -7.355213e-04, 3.573298e-04,  -1.647035e-03,
      8.401275e-04,  -2.249430e-03, 1.368652e-03,  -2.191295e-03, 5.165388e-04,
      -1.330350e-03, -4.463270e-04, -5.836999e-04, -1.575870e-03, 6.832778e-04,
      -2.457311e-03, 1.019826e-03,  -2.467291e-03, 8.464592e-04,  -2.282379e-03,
      1.508842e-04,  -1.055092e-03, -1.126825e-03, 2.190781e-04,  -1.820356e-03,
      1.185340e-03,  -2.537098e-03, 1.701899e-03,  -2.299716e-03, 1.137601e-03,
      -1.349005e-03, 4.276559e-04,  -1.250443e-04, -7.305462e-04, 1.414449e-03,
      -1.686553e-03, 2.059038e-03,  -2.011319e-03, 2.383440e-03,  -1.768370e-03,
      1.812800e-03,  -5.507294e-04, 7.679813e-04,  7.357218e-04,  -3.284188e-04,
      2.108756e-03,  -1.332157e-03, 3.072582e-03,  -1.340225e-03, 3.202576e-03,
      -8.072673e-04, 2.774303e-03,  2.810390e-04,  1.531250e-03,  1.826262e-03,
      4.990382e-04,  3.112022e-03,  -2.827022e-04, 4.154691e-03,  -4.524390e-04,
      4.093876e-03,  -1.200133e-05, 3.397725e-03,  1.140137e-03,  2.504312e-03,
      2.651623e-03,  1.157897e-03,  3.633740e-03,  4.873167e-04,  4.357196e-03,
      2.033551e-04,  4.536784e-03,  6.900835e-04,  3.865227e-03,  1.638831e-03,
      2.918299e-03,  2.626599e-03,  1.840488e-03,  3.732218e-03,  1.223449e-03,
      4.348582e-03,  9.199454e-04,  4.464032e-03,  1.076058e-03,  3.978268e-03,
      1.714359e-03,  3.252655e-03,  2.512654e-03,  2.564728e-03,  3.259063e-03,
      1.668990e-03,  3.770622e-03,  1.352092e-03,  3.926158e-03,  1.302669e-03,
      3.750666e-03,  1.495771e-03,  3.138885e-03,  1.836255e-03,  2.584351e-03,
      2.265138e-03,  2.183765e-03,  2.841537e-03,  1.681924e-03,  2.773735e-03,
      1.419358e-03,  2.935763e-03,  1.116987e-03,  2.871724e-03,  1.032200e-03,
      2.653779e-03,  1.025664e-03,  2.427404e-03,  1.123367e-03,  1.928403e-03,
      1.506626e-03,  1.441597e-03,  1.753684e-03,  7.041625e-04,  2.107783e-03,
      -4.818787e-05, 2.463182e-03,  -2.613651e-04, 2.550895e-03,  -6.512853e-04,
      2.112367e-03,  -4.114124e-04, 1.316327e-03,  1.585454e-04,  4.117840e-04,
      8.352045e-04,  -8.052015e-04, 1.984167e-03,  -1.839687e-03, 2.311909e-03,
      -2.691229e-03, 2.198165e-03,  -3.053411e-03, 1.286946e-03,  -1.654503e-03,
      6.852901e-04,  -6.514266e-04, -1.307959e-03, 8.826529e-04,  -3.930216e-03,
      1.640175e-03,  -4.707950e-03, 2.089381e-03,  -5.723208e-03, 1.886628e-03,
      -5.063246e-03, 8.766664e-05,  -3.005792e-03, -1.093705e-03, -4.154065e-04,
      -4.097001e-03, 1.527195e-03,  -7.559044e-03, 1.954487e-03,  -8.667807e-03,
      4.182535e-03,  -7.091756e-03, 3.433545e-03,  -5.788472e-03, -6.993040e-04,
      -3.235788e-03, -3.544214e-03, 2.700659e-03,  -7.411534e-03};

  std::vector<Sample> cmp_up_right = {
      7.937889e-03,  -1.007681e-02, 2.782161e-03,  -8.900892e-03, -5.446732e-03,
      -3.629952e-03, -1.399141e-02, 8.900775e-03,  -2.031563e-02, 3.163501e-02,
      -3.824360e-02, 1.861081e-01,  3.886467e-01,  5.313745e-01,  8.558491e-01,
      7.404515e-01,  -3.692487e-01, -1.338452e+00, -8.278484e-01, -1.944550e-01,
      2.773130e-01,  4.401017e-01,  2.317244e-01,  1.120465e-01,  -1.680049e-02,
      3.282332e-03,  1.080248e-02,  4.557891e-02,  2.710407e-02,  -2.921909e-02,
      -1.567413e-01, -1.000324e-01, 3.717541e-02,  4.662116e-02,  -1.452170e-02,
      -9.127361e-02, -8.564961e-03, 8.923952e-02,  1.555959e-01,  8.208778e-02,
      -8.162176e-03, -6.349837e-02, -2.583272e-02, 1.798891e-02,  -6.450040e-03,
      -1.942451e-02, -3.036141e-02, -1.283364e-02, -7.044175e-03, 5.140632e-03,
      1.413321e-02,  5.003181e-02,  2.656584e-02,  1.955500e-03,  -2.790317e-03,
      1.439412e-02,  5.060470e-02,  5.180162e-02,  -3.116240e-03, -7.308375e-02,
      -8.238615e-02, -8.523498e-02, -5.994488e-02, -2.189403e-02, 7.366722e-03,
      4.947986e-03,  2.221376e-02,  2.937654e-02,  2.159811e-02,  4.127936e-02,
      5.597018e-02,  1.597736e-02,  -5.224212e-02, -6.819221e-02, -5.062656e-02,
      -1.172967e-02, 1.062931e-02,  2.000888e-02,  9.804842e-03,  1.135192e-02,
      8.914883e-03,  8.472673e-03,  4.512482e-03,  -5.830558e-03, -6.650908e-03,
      -1.495493e-02, -3.024871e-03, 2.922722e-03,  3.657265e-03,  -6.325135e-03,
      -9.873363e-03, -1.386296e-02, -2.163838e-03, 8.977060e-03,  1.132674e-02,
      2.451009e-03,  -8.946395e-03, -4.393966e-03, -4.027862e-03, 8.377837e-05,
      -8.603308e-04, -2.967278e-04, -5.267050e-03, 3.645069e-03,  3.239556e-03,
      6.719645e-03,  5.527057e-03,  4.771293e-03,  -7.439852e-04, -7.018358e-03,
      1.333356e-03,  -9.449919e-04, 1.985769e-03,  -4.045844e-03, -2.351602e-04,
      -5.815556e-03, -7.111232e-04, -2.899766e-04, 3.028264e-04,  -2.049066e-03,
      -2.365808e-03, 2.787891e-03,  -3.637784e-03, 2.262414e-03,  -9.361182e-04,
      3.126691e-03,  -4.393215e-03, -8.389453e-04, -1.519869e-03, 2.140341e-04,
      1.817194e-04,  -2.624714e-03, -3.743233e-03, -7.183682e-03, 1.793263e-03,
      -2.740745e-03, 6.576173e-04,  -1.675573e-03, 3.795229e-03,  8.194204e-04,
      2.219150e-03,  4.211456e-03,  3.224332e-03,  2.646178e-03,  -2.932400e-04,
      8.938631e-04,  -5.263717e-03, -4.709841e-04, -3.299849e-03, -8.245658e-04,
      -2.922001e-03, 1.755940e-03,  -2.192544e-04, -2.727505e-03, 3.604689e-04,
      -2.674609e-04, 1.217227e-03,  -1.557366e-03, 1.833625e-03,  -2.363056e-03,
      1.915304e-05,  -1.303854e-03, 3.847883e-04,  -1.796629e-03, -1.011757e-03,
      7.006886e-04,  -1.502575e-03, -2.773022e-04, -1.740674e-03, -7.263323e-05,
      -2.201668e-03, 1.028534e-03,  -3.422924e-04, -2.299078e-04, -6.003362e-04,
      1.409683e-03,  7.720022e-04,  -8.196916e-04, -1.475010e-04, -1.597988e-03,
      -5.744969e-04, -2.871541e-04, 1.624966e-03,  -3.573493e-04, 2.484635e-04,
      2.860395e-04,  6.944697e-04,  1.075054e-04,  9.948752e-04,  6.937089e-04,
      -3.719904e-04, 1.420748e-05,  4.098257e-04,  8.222585e-05,  -6.262499e-04,
      3.377580e-04,  -4.368251e-04, -3.976527e-04, -3.843278e-04, 7.387089e-04,
      -7.306899e-04, 5.909738e-05,  -1.347090e-04, 1.728932e-04,  -6.754796e-04,
      2.479156e-04,  2.320607e-04,  -6.421010e-04, 1.069506e-04,  -4.878839e-04,
      2.066294e-06,  -1.511971e-03, 6.025831e-04,  -1.049161e-03, 9.198983e-06,
      -8.037289e-04, 2.669947e-04,  -9.081436e-04, -8.502702e-04, 1.152357e-06,
      -1.381284e-03, -2.339246e-04, -1.512994e-03, 4.924287e-04,  -2.108444e-03,
      2.779588e-04,  -1.333061e-03, -3.372332e-04, -1.408481e-03, -5.213221e-04,
      -4.579872e-04, -1.688118e-03, 1.810386e-04,  -1.731167e-03, 2.785673e-04,
      -2.137364e-03, 8.410523e-04,  -1.880062e-03, 1.742815e-05,  -1.012599e-03,
      -2.194798e-04, -6.275091e-04, -9.906174e-04, 6.795377e-04,  -1.654670e-03,
      9.576785e-04,  -1.505878e-03, 1.358985e-03,  -1.675283e-03, 1.235443e-03,
      -6.143608e-04, 3.848995e-04,  3.359094e-05,  1.012161e-05,  9.123012e-04,
      -9.654813e-04, 1.879617e-03,  -1.029736e-03, 1.933596e-03,  -9.236044e-04,
      2.257894e-03,  -4.181998e-04, 1.484187e-03,  7.983393e-04,  9.125918e-04,
      1.543745e-03,  4.128801e-04,  2.622129e-03,  -2.439149e-04, 2.949957e-03,
      8.047613e-05,  2.985108e-03,  3.207715e-04,  2.913805e-03,  1.154873e-03,
      2.039723e-03,  2.034856e-03,  1.575568e-03,  2.831978e-03,  8.477907e-04,
      3.797567e-03,  6.017847e-04,  3.631981e-03,  7.629919e-04,  3.644630e-03,
      1.207133e-03,  3.164785e-03,  2.190047e-03,  2.295403e-03,  2.856134e-03,
      1.759609e-03,  3.623243e-03,  1.027905e-03,  4.052897e-03,  1.086396e-03,
      4.088033e-03,  1.210170e-03,  3.923186e-03,  1.624711e-03,  3.026097e-03,
      2.533793e-03,  2.362798e-03,  3.123522e-03,  1.625359e-03,  3.968298e-03,
      9.330511e-04,  4.055818e-03,  8.484821e-04,  4.074156e-03,  9.977022e-04,
      3.734445e-03,  1.626762e-03,  2.641043e-03,  2.245303e-03,  1.845649e-03,
      3.048742e-03,  1.003999e-03,  3.812117e-03,  4.452616e-04,  3.868719e-03,
      2.104684e-04,  3.871725e-03,  3.324744e-04,  3.120222e-03,  1.015820e-03,
      2.102704e-03,  1.746548e-03,  1.065633e-03,  2.735157e-03,  -5.712624e-05,
      3.376896e-03,  -6.957768e-04, 3.723253e-03,  -1.026584e-03, 3.512649e-03,
      -7.579659e-04, 2.403188e-03,  1.888227e-04,  1.284747e-03,  1.289170e-03,
      -4.202953e-04, 2.515366e-03,  -1.636716e-03, 3.143032e-03,  -2.453862e-03,
      3.261115e-03,  -2.697334e-03, 2.714063e-03,  -1.936520e-03, 1.487032e-03,
      -6.752089e-04, -1.920164e-04, 5.682207e-04,  -2.423900e-03, 2.260183e-03,
      -3.793870e-03, 2.873687e-03,  -4.748529e-03, 3.328120e-03,  -4.575236e-03,
      1.725733e-03,  -3.540595e-03, 5.795062e-05,  -1.878846e-03, -2.478464e-03,
      3.948491e-04,  -5.206699e-03, 2.258978e-03,  -6.624978e-03, 3.548108e-03,
      -7.549859e-03, 3.583692e-03,  -6.761116e-03, 1.495885e-03,  -5.002148e-03,
      -1.247304e-03, -1.878026e-03, -4.602599e-03, 2.180362e-03,  -7.918050e-03,
      5.196759e-03,  -1.031949e-02, 7.982539e-03,  -1.039527e-02};

  /* For this one I used a distance of 2 m instead of 1 m like the others
  because otherwise the results don't seem to match. I belive that might
   be due to the fact that at the zenith there are 360 different responses
   (1 degree azimuth) and it is possible that the CPP implementation picks
   a different azimuth at 1m and 2m. I don't think this is problematic
   since it is an edge case, and the responses are very close anyways. */
  Test(Point(0.0, 0.0, 2.0), cmp_up_left, cmp_up_right);

  return true;
}

}  // namespace sal
